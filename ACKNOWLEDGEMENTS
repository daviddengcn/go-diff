Dmitri Shuralyov (@shurcooL) for cleaning up of the code.
